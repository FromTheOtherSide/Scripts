#https://tpope.io/vim/fugitive.gitcka!/bin/bash
# Another fucking vim packager manager. I made      ___  ___  _  ___  ___ ___  #
# this when there are several very good pms        |__ \/ __|| || _ \/ __/ __| #
# freely available and I dont even know why!       / __/\__ \| |||_| | _/\__ \ #
#                                                  \___/\___/|_||___/\___\___/ #

while getopts 'fpP' opt; do
	case "$opt" in
		p) type=plug ;;
		P) type=pack ;;
		f) type=ftplug ;;
		*) usage ;;
	esac
done
shift $(( OPTIND-1 ))
giturl="$1"

case $type in
	pack) dir="$HOME/.local/share/nvim/site/pack" ;;
	plug) dir="$HOME/.local/share/nvim/site/plugin" ;;
	ftplug) dir="$HOME/.local/share/nvim/site/ftplugin" ;;
esac

humanish="$(echo "$1" | sed -Ee 's/.*\/(.*)\.[[:alnum:]]+/\1/')"

# Clone repo into vim
[[ -d  "$dir/$humanish" ]] && rm -rdf "$dir/$humanish"
mkdir -p  "$dir"
cd "$dir"
git clone "$giturl" "$humanish/"

nvim -u NONE -c "helptags $dir/$humanish/doc/" -c q
# mkdir -p "$HOME/.local/share/nvim/site/doc"
# sleep 1
# if [[ -d "$dir/start/$humanish/doc" ]]; then
# 	echo 'doc dir found'
# 	for i in $dir/start/$humanish/doc/*; do
# 		cp "$i" "$HOME/.local/share/nvim/site/doc"
# 		sleep 1
# 	done
# fi
# nvim -u NONE -c "helptags $HOME/.local/share/nvim/site/doc" -c q"
# Import the help

# Package Directory
# ~/.local/share/nvim/site/pack

# Global Plugin Directory
# ~/.local/share/nvim/site/plugin

# File Type Plugin Directory
# ~/.local/share/nvim/site/ftplugin

# Help File
# ~/.local/share/nvim/site/doc

# Add help file
# helptags ~/.local/share/nvim/site/doc


# Your directory layout would be like this:
#    start/foobar/plugin/foo.vim    	" always loaded, defines commands
#    start/foobar/plugin/bar.vim    	" always loaded, defines commands
#    start/foobar/autoload/foo.vim  	" loaded when foo command used
#    start/foobar/doc/foo.txt       	" help for foo.vim
#    start/foobar/doc/tags          	" help tags
#    opt/fooextra/plugin/extra.vim  	" optional plugin, defines commands
#    opt/fooextra/autoload/extra.vim  	" loaded when extra command used
#    opt/fooextra/doc/extra.txt  	        " help for extra.vim
#    opt/fooextra/doc/tags  	        " help tags


